<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>请输入访问密码</title>
</head>
<body>
  <h2>请输入访问密码</h2>
  <input type="password" id="password" placeholder="请输入密码" />
  <button onclick="login()">进入</button>
  <div id="msg" style="color:red;"></div>
  <script>
    // 15个不同的密码
    const PASSWORD_LIST = [
      "abc123", "def456", "ghi789", "jkl012", "mno345",
      "pqr678", "stu901", "vwx234", "yzA567", "BCD890",
      "EFG123", "HIJ456", "KLM789", "NOP012", "QRS345"
    ];

    function login() {
      const input = document.getElementById('password').value.trim();
      if (PASSWORD_LIST.includes(input)) {
        // 检查是否已用过
        if (localStorage.getItem('video_pwd_used_' + input) === '1') {
          document.getElementById('msg').innerText = '该密码已被使用，请勿重复使用！';
        } else {
          // 标记为已用
          localStorage.setItem('video_pwd_used_' + input, '1');
          // 生成一次性 token
          const token = Date.now() + '_' + Math.random().toString(36).substr(2, 8);
          localStorage.setItem('video_token_used_' + token, '0');
          // 跳转并带 token
          window.location.href = 'video.html?token=' + token + '&pwd=' + encodeURIComponent(input);
        }
      } else {
        document.getElementById('msg').innerText = '密码错误，请重试！';
      }
    }
  </script>
</body>
</html>
